# Лабораторная работа №3

## Данные
Для задачи классификации выбран датасет для классификации типов звезд (доступен по [ссылке](https://www.kaggle.com/datasets/deepu1109/star-dataset)). По температуре, относительной освещенности, относительному радиусу, абсолютной величине, цвету и спектральному классу определить тип звезды (один из следующих классов: *Brown Dwarf*, *Red Dwarf*, *White Dwarf*, *Main Sequence*, *Supergiant* и *Hypergiant*).

Построен график зависимости абсолютной величины от температуры, цвет точки - тип звезды.

<p align="center">
    <img src="assets/classification_dataset_sample.png" width=400>
</p>

Данные содержат категориальные и количественные признаки, которые будут кодированы в коде.

## Реализация метода

На этапе обучения вычисляется априорная вероятность, среднее по выборке и среднее отклонение для каждого класса. На этапе предсказания вычисляется логарифм априорной вероятности, к нему прибавляется сумма логарифмов правдоподобия по каждому классу для данного объекта. Предсказанный класс - `argmax` среди полученных вероятностей. 

## Сравнение

### Время работы
Время, затраченное на обучение:
 - Кастомный алгоритм: 0.853 мс
 - Sklearn алгоритм: 1.187 мс

Время, затраченное на предсказание:
 - Кастомный алгоритм: 3.001 мс
 - Sklearn алгоритм: 0.812 мс

Данная разница во времени связана с разными реализациями векторных вычислений в методах `fit()` и `predict()`, а также с внутренними ускорениями в `numpy`.

### Качество работы

Качество работы кастомного алгоритма для каждого класса:
```
              precision    recall  f1-score   support

           0       1.00      1.00      1.00        15
           1       1.00      1.00      1.00        17
           2       1.00      0.89      0.94        18
           3       0.83      0.77      0.80        13
           4       0.81      1.00      0.90        13
           5       1.00      1.00      1.00        20

    accuracy                           0.95        96
   macro avg       0.94      0.94      0.94        96
weighted avg       0.95      0.95      0.95        96
```

Качество работы алгоритма Sklearn для каждого класса:
```
              precision    recall  f1-score   support

           0       0.92      0.80      0.86        15
           1       0.84      0.94      0.89        17
           2       0.86      1.00      0.92        18
           3       1.00      0.54      0.70        13
           4       0.81      1.00      0.90        13
           5       1.00      1.00      1.00        20

    accuracy                           0.90        96
   macro avg       0.91      0.88      0.88        96
weighted avg       0.91      0.90      0.89        96
```
Качество работы кастомного алгоритма чуть выше.

Также качество работы алгоритма определяется при помощи кросс-валидации. Для этого была написана следующая функция:
```python
def cross_validate(model, X, y, n_folds=5):
    scores = []
    for n in range(n_folds):
        model2fit = copy.deepcopy(model)
        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.4)
        model2fit.fit(X_train, y_train)
        scores += [accuracy_score(y_test, model2fit.predict(X_test))]
    return scores
```

Использовалась валидация на 20 выборках, оценка модели выполняется через метрику accuracy.

* Кастомный алгоритм: 0.962
* Sklearn алгоритм: 0.852

